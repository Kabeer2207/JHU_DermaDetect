<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI-Powered Skin Health Center</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app-layout">
      <!-- Header -->
      <header class="header">
        <div class="container">
          <div class="header-content">
            <a href="#" class="logo">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                style="margin-right: 8px"
              >
                <path d="M3 21h18l-9-18z" />
                <path d="M12 9v4" />
                <path d="M12 17h.01" />
              </svg>
              DermaDetect
            </a>
            <nav class="nav-icons">
              <div
                class="nav-icon theme-toggle"
                title="Toggle Theme"
                onclick="toggleTheme()"
              >
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="theme-icon-light"
                >
                  <circle cx="12" cy="12" r="5" />
                  <path
                    d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
                  />
                </svg>
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="theme-icon-dark"
                  style="display: none"
                >
                  <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                </svg>
              </div>
            </nav>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="main-content">
        <div class="container">
          <!-- Hero Section -->
          <section class="hero">
            <h1 class="hero-title">DermaDetect</h1>
            <p class="hero-info">
              Our AI-powered platform provides instant skin condition analysis <br />
              Currently supports Acne, Eczema, Keratosis, Millia and Psoriasis detection <br />
              Upload a clear image of your skin condition to get started
            </p>
          </section>

          <!-- Upload Section -->
          <section class="upload-section">
            <div
              class="upload-card"
              id="uploadCard"
              onclick="handleImageUpload()"
            >
              <div class="upload-icon">
                <svg
                  width="48"
                  height="48"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                  />
                  <polyline points="14,2 14,8 20,8" />
                  <line x1="16" y1="17" x2="8" y2="17" />
                  <!-- <line x1="25" y1="27" x2="10" y2="27" /> -->
                  <line x1="16" y1="13" x2="8" y2="13" />
                  <polyline points="10,9 9,9 8,9" />
                </svg>
              </div>
              <p class="upload-text">Upload a Picture</p>
              <p class="upload-subtext">
                Drag & drop an image here or click to browse
              </p>
              <p class="upload-subtext">Ensure Good Lighting And Clear Focus</p>
            </div>

            <!-- Hidden file input -->
            <input type="file" id="fileInput" accept="image/*" class="hidden" />
          </section>
        </div>
      </main>
    </div>

    <!-- Scripts -->
    <script>
      // Initialize drag and drop functionality
      document.addEventListener("DOMContentLoaded", function () {
        const uploadCard = document.getElementById("uploadCard");
        const fileInput = document.getElementById("fileInput");

        // Handle file input change
        fileInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file && file.type.startsWith("image/")) {
            processImage(file);
          } else if (file) {
            alert("Please select an image file");
          }
        });

        // Drag and drop events
        uploadCard.addEventListener("dragover", function (e) {
          e.preventDefault();
          uploadCard.classList.add("drag-over");
        });

        uploadCard.addEventListener("dragleave", function (e) {
          e.preventDefault();
          uploadCard.classList.remove("drag-over");
        });

        uploadCard.addEventListener("drop", function (e) {
          e.preventDefault();
          uploadCard.classList.remove("drag-over");

          const files = e.dataTransfer.files;
          if (files.length > 0) {
            const file = files[0];
            if (file.type.startsWith("image/")) {
              processImage(file);
            } else {
              alert("Please drop an image file");
            }
          }
        });
      });

      function handleImageUpload() {
        // Simply trigger file input
        document.getElementById("fileInput").click();
      }

      async function processImage(imageData) {
        try {
          // Store image for analysis page display
          localStorage.setItem("uploadedImage", URL.createObjectURL(imageData));

          // Convert image to base64 for API
          const base64Image = await convertToBase64(imageData);
          localStorage.setItem("imageBase64", base64Image);

          // Redirect to analysis page which will handle the API call
          window.location.href = "page2.html";
        } catch (error) {
          console.error("Error processing image:", error);
          alert("Error processing image. Please try again.");
        }
      }

      // Helper function to convert file/blob to base64
      function convertToBase64(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.readAsDataURL(file);
          reader.onload = () => resolve(reader.result);
          reader.onerror = (error) => reject(error);
        });
      }

      // Theme toggle functionality
      function toggleTheme() {
        const body = document.body;
        const lightIcon = document.querySelector(".theme-icon-light");
        const darkIcon = document.querySelector(".theme-icon-dark");

        if (body.classList.contains("dark-theme")) {
          body.classList.remove("dark-theme");
          lightIcon.style.display = "block";
          darkIcon.style.display = "none";
          localStorage.setItem("theme", "light");
        } else {
          body.classList.add("dark-theme");
          lightIcon.style.display = "none";
          darkIcon.style.display = "block";
          localStorage.setItem("theme", "dark");
        }
      }

      // Load saved theme on page load
      document.addEventListener("DOMContentLoaded", function () {
        const savedTheme = localStorage.getItem("theme");
        const lightIcon = document.querySelector(".theme-icon-light");
        const darkIcon = document.querySelector(".theme-icon-dark");

        if (savedTheme === "dark") {
          document.body.classList.add("dark-theme");
          lightIcon.style.display = "none";
          darkIcon.style.display = "block";
        } else {
          document.body.classList.remove("dark-theme");
          lightIcon.style.display = "block";
          darkIcon.style.display = "none";
        }
      });
    </script>
  </body>
</html>
